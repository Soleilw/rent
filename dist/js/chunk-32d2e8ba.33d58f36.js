(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32d2e8ba"],{"0502":function(e,t,a){},1276:function(e,t,a){"use strict";var n=a("d784"),r=a("44e7"),l=a("825a"),o=a("1d80"),i=a("4840"),s=a("8aa5"),c=a("50c4"),u=a("14c3"),g=a("9263"),d=a("d039"),f=[].push,p=Math.min,h=4294967295,m=!d((function(){return!RegExp(h,"y")}));n("split",2,(function(e,t,a){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,a){var n=String(o(this)),l=void 0===a?h:a>>>0;if(0===l)return[];if(void 0===e)return[n];if(!r(e))return t.call(n,e,l);var i,s,c,u=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,m=new RegExp(e.source,d+"g");while(i=g.call(m,n)){if(s=m.lastIndex,s>p&&(u.push(n.slice(p,i.index)),i.length>1&&i.index<n.length&&f.apply(u,i.slice(1)),c=i[0].length,p=s,u.length>=l))break;m.lastIndex===i.index&&m.lastIndex++}return p===n.length?!c&&m.test("")||u.push(""):u.push(n.slice(p)),u.length>l?u.slice(0,l):u}:"0".split(void 0,0).length?function(e,a){return void 0===e&&0===a?[]:t.call(this,e,a)}:t,[function(t,a){var r=o(this),l=void 0==t?void 0:t[e];return void 0!==l?l.call(t,r,a):n.call(String(r),t,a)},function(e,r){var o=a(n,e,this,r,n!==t);if(o.done)return o.value;var g=l(e),d=String(this),f=i(g,RegExp),b=g.unicode,v=(g.ignoreCase?"i":"")+(g.multiline?"m":"")+(g.unicode?"u":"")+(m?"y":"g"),x=new f(m?g:"^(?:"+g.source+")",v),y=void 0===r?h:r>>>0;if(0===y)return[];if(0===d.length)return null===u(x,d)?[d]:[];var D=0,_=0,C=[];while(_<d.length){x.lastIndex=m?_:0;var w,k=u(x,m?d:d.slice(_));if(null===k||(w=p(c(x.lastIndex+(m?0:_)),d.length))===D)_=s(d,_,b);else{if(C.push(d.slice(D,_)),C.length===y)return C;for(var z=1;z<=k.length-1;z++)if(C.push(k[z]),C.length===y)return C;_=D=w}}return C.push(d.slice(D)),C}]}),!m)},"44b4":function(e,t,a){"use strict";var n=a("0502"),r=a.n(n);r.a},"9e8d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中"}},[a("div",{staticClass:"handle-box"},[a("div",{staticClass:"btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addDangerFace}},[e._v("添加可疑人物")])],1)]),a("el-dialog",{attrs:{title:"添加可疑人物",visible:e.dialogDangerFace,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogDangerFace=t}}},[a("div",{staticClass:"box"},[a("el-form",{attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"身份证号"}},[a("el-input",{attrs:{placeholder:"请输入身份证号"},model:{value:e.form.number,callback:function(t){e.$set(e.form,"number",t)},expression:"form.number"}})],1),a("el-form-item",{attrs:{label:"通知相似度"}},[a("el-input",{attrs:{placeholder:"请输入通知相似度(保留一位小数, 例如78.9)"},model:{value:e.form.notify_score,callback:function(t){e.$set(e.form,"notify_score",t)},expression:"form.notify_score"}})],1),a("el-form-item",{attrs:{label:"通知手机号"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入手机号, 多个手机号用逗号分隔(例如: 13212312312,13212312312)"},model:{value:e.notify_user,callback:function(t){e.notify_user=t},expression:"notify_user"}})],1),a("el-form-item",{attrs:{label:"人脸图片"}},[a("el-upload",{ref:"upload",attrs:{action:"https://api.fengniaotuangou.cn/api/upload",limit:1,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChange,"on-success":e.handleAvatarSuccess,"on-remove":e.handleRemove,"on-exceed":e.handleExceed,"auto-upload":!1}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("选择图片")])],1),e.hasNewImage?a("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("* 点击文件名可删除所选图片")]):e._e(),a("div",{staticClass:"up-img"},[a("img",{staticClass:"pic-box",attrs:{src:e.form.href}})])],1),a("div",{staticClass:"submit"},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.upload}},[e._v("提交")])],1)],1)],1)],1)]),a("el-table",{attrs:{data:e.tableData,"empty-text":"暂无数据",border:"","header-cell-style":{background:"#f0f0f0"},"max-height":"620"}},[a("el-table-column",{attrs:{prop:"id",label:"ID"}}),a("el-table-column",{attrs:{prop:"",label:"设备ID"}}),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),a("el-table-column",{attrs:{prop:"created_at",label:"时间"}}),a("el-table-column",{attrs:{prop:"number",label:"人脸证件号"}}),a("el-table-column",{attrs:{prop:"href",label:"人脸图片"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.href?a("div",[a("el-popover",{attrs:{placement:"top-start",title:"",trigger:"click"}},[a("img",{staticStyle:{"max-width":"800px","max-height":"800px"},attrs:{src:t.row.href}}),a("img",{staticStyle:{"max-width":"180px","max-height":"80px"},attrs:{slot:"reference",src:t.row.href},slot:"reference"})])],1):a("div",[a("span",[e._v("--暂无图片--")])])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.handleLogs(t.$index,t.row)}}},[e._v("进出记录")])]}}])})],1),a("el-dialog",{attrs:{title:"进出记录",visible:e.dialogLogs},on:{"update:visible":function(t){e.dialogLogs=t}}},[a("div",{staticClass:"box"},[a("el-table",{attrs:{data:e.logsData,border:"","header-cell-style":{background:"#f0f0f0"},"max-height":"620"}},[a("el-table-column",{attrs:{prop:"danger.name",label:"姓名"}}),a("el-table-column",{attrs:{prop:"address",label:"地址"}}),a("el-table-column",{attrs:{prop:"danger.number",label:"证件号"}}),a("el-table-column",{attrs:{prop:"log.timestamp",label:"时间"}}),a("el-table-column",{attrs:{prop:"danger.href",label:"人脸照片"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.danger.href?a("div",[a("el-popover",{attrs:{placement:"top-start",title:"",trigger:"click"}},[a("img",{staticStyle:{"max-width":"800px","max-height":"800px"},attrs:{src:t.row.danger.href}}),a("img",{staticStyle:{"max-width":"180px","max-height":"80px"},attrs:{slot:"reference",src:t.row.danger.href},slot:"reference"})])],1):a("div",[a("span",[e._v("--暂无图片--")])])]}}])})],1)],1),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.logsCurrent,"page-sizes":[10,20,30,40,50],"page-size":e.logsSize,layout:"sizes, prev, pager, next, jumper",total:e.logsTotal},on:{"current-change":e.logsCurrentChange,"update:currentPage":function(t){e.logsCurrent=t},"update:current-page":function(t){e.logsCurrent=t},"size-change":e.logsSizeChange}})],1)]),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[10,20,30,40,50],"page-size":e.size,layout:"sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.currentChange,"update:currentPage":function(t){e.current=t},"update:current-page":function(t){e.current=t},"size-change":e.sizeChange}})],1)],1)},r=[],l=(a("4160"),a("d3b7"),a("ac1f"),a("3ca3"),a("1276"),a("159b"),a("ddb0"),a("2b3d"),a("365c")),o=(a("3022"),a("25f0"),a("5319"),{});function i(e){return e=e.toString(),e[1]?e:"0"+e}o.formatTime=function(e,t){var a=["Y","M","D","h","m","s"],n=[],r=new Date(1e3*e);for(var l in n.push(r.getFullYear()),n.push(i(r.getMonth()+1)),n.push(i(r.getDate())),n.push(i(r.getHours())),n.push(i(r.getMinutes())),n.push(i(r.getSeconds())),n)t=t.replace(a[l],n[l]);return t};var s=o,c={data:function(){return{loading:!0,tableData:[],current:1,size:10,total:0,dialogDangerFace:!1,qiniuaddr:"https://tu.fengniaotuangou.cn",hasNewImage:!1,form:{name:"",number:"",href:"",notify_score:"",notify_user:""},dialogLogs:!1,logsData:[],danger_id:"",logsCurrent:1,logsSize:10,logsTotal:0,notify_user:""}},mounted:function(){this.getDangerFace()},methods:{getDangerFace:function(){var e=this;l["a"].dangerFace(e.current,e.size).then((function(t){e.loading=!1,console.log("getDangerFace",t.data.data),e.tableData=t.data.data,e.total=t.data.total})).catch((function(t){e.loading=!1}))},currentChange:function(e){var t=this;console.log(e),t.current=e,t.loading=!0,l["a"].dangerFace(e,t.size).then((function(e){t.loading=!1,t.tableData=e.data.data,t.total=e.data.total})).catch((function(e){t.loading=!1}))},sizeChange:function(e){var t=this;console.log(e),t.size=e,t.loading=!0,l["a"].dangerFace(t.current,e).then((function(e){t.loading=!1,t.tableData=e.data.data,t.total=e.data.total})).catch((function(e){t.loading=!1}))},addDangerFace:function(){var e=this;e.dialogDangerFace=!0},handleLogs:function(e,t){var a=this;a.dialogLogs=!0,a.danger_id=t.danger_id,a.logsCurrent=1,a.getFaceLogs()},getFaceLogs:function(){var e=this;l["a"].dangerLog(e.logsCurrent,e.logsSize,e.danger_id).then((function(t){console.log("getFaceLogs",t.data.data),e.logsData=t.data.data,e.logTlogsTotal=t.data.total,e.logsData.forEach((function(e){e.log.timestamp=s.formatTime(e.log.timestamp,"Y-M-D h:m:s")}))}))},logsCurrentChange:function(e){var t=this;t.logsCurrent=e,l["a"].dangerLog(e,t.logsSize,t.danger_id).then((function(e){t.logsData=e.data.data,t.logsData.forEach((function(e){e.log.timestamp=s.formatTime(e.log.timestamp,"Y-M-D h:m:s")}))}))},logsSizeChange:function(e){var t=this;t.logsSize=e,l["a"].dangerLog(t.logsCurrent,e,t.danger_id).then((function(e){t.logsData=e.data.data,t.logsData.forEach((function(e){e.log.timestamp=s.formatTime(e.log.timestamp,"Y-M-D h:m:s")}))}))},handleRemove:function(e,t){var a=this;a.form.href="",a.hasNewImage=!1},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传图片大小不能超过 2MB!"),t},handleChange:function(e){var t=this;t.form.href=URL.createObjectURL(e.raw),t.hasNewImage=!0},handleAvatarSuccess:function(e,t){var a=this;t.url=e.data,a.form.href=t.url;var n=a.notify_user.split(","),r=[];n.forEach((function(e){e="+86"+e,r.push(e)})),a.form.notify_user=r.toString(),l["a"].addDangerFace(a.form).then((function(e){a.$message.success("上传成功"),a.current=1,a.getDangerFace(),a.$refs.upload.clearFiles(),a.form={name:"",number:"",href:"",notify_score:"",notify_user:""},a.notify_user="",a.dialogDangerFace=!1}))},handleExceed:function(e,t){var a=this;a.$message.error("上传图片不能超过1张!"),a.$refs.upload.clearFiles(),a.form.href="",a.form.id=""},upload:function(){var e=this;e.$refs.upload.submit()},getQiniuToken:function(){var e=this;axios.get("https://api.fengniaotuangou.cn/api/upload/token").then((function(t){e.imgData.token=t.data.uptoken}))}}},u=c,g=(a("44b4"),a("2877")),d=Object(g["a"])(u,n,r,!1,null,"4d846472",null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-32d2e8ba.33d58f36.js.map